const ephemeride = {
    "Janvier": [
        ["Jour de l'An", ""],
        ["Basile", "Saint"],
        ["Geneviève", "Sainte"],
        ["Odilon", "Saint"],
        ["Edouard", "Saint"],
        ["Mélaine", "Saint"],
        ["Raymond", "Saint"],
        ["Lucien", "Saint"],
        ["Alix", "Sainte"],
        ["Guillaume", "Saint"],
        ["Pauline", "Saint"],
        ["Tatiana", "Sainte"],
        ["Yvette", "Sainte"],
        ["Nina", "Sainte"],
        ["Rémi", "Saint"],
        ["Marcel", "Saint"],
        ["Roseline", "Sainte"],
        ["Prisca", "Sainte"],
        ["Marius", "Saint"],
        ["Sébastien", "Saint"],
        ["Agnès", "Sainte"],
        ["Vincent", "Saint"],
        ["Barnard", "Saint"],
        ["François de Sales", "Saint"],
        ["Conversion de Paul", ""],
        ["Paule", "Sainte"],
        ["Angèle", "Sainte"],
        ["Thomas d'Aquin", "Saint"],
        ["Gildas", "Saint"],
        ["Martine", "Sainte"],
        ["Marcelle", "Sainte"]
    ],
    "Février": [
        ["Ella", "Sainte"],
        ["Fête de la Présention", ""],
        ["Blaise", "Saint"],
        ["Véronique", "Sainte"],
        ["Agathe", "Sainte"],
        ["Gaston", "Saint"],
        ["Eugènie", "Sainte"],
        ["Jacqueline", "Sainte"],
        ["Apolline", "Sainte"],
        ["Arnaud", "Saint"],
        ["Notre Dame de Lourdes", "Sainte"],
        ["Félix", "Saint"],
        ["Béatrice", "Sainte"],
        ["Valentin", "Saint"],
        ["Claude", "Saint"],
        ["Julienne", "Sainte"],
        ["Alexis", "Saint"],
        ["Bernadette", "Sainte"],
        ["Gabin", "Saint"],
        ["Aimée", "Sainte"],
        ["Mercredi des Cendres", ""],
        ["Isabelle", "Sainte"],
        ["Lazare", "Saint"],
        ["Modeste", "Sainte"],
        ["Roméo", "Saint"],
        ["Nestor", "Saint"],
        ["Honorine", "Sainte"],
        ["Romain", "Saint"],
        ["Auguste", "Saint"]
    ],
    "Mars": [
        ["Aubin", "Saint"],
        ["Charles le Bon", "Saint"],
        ["Guénolé", "Saint"],
        ["Casimir", "Saint"],
        ["Olive", "Saint"],
        ["Colette", "Sainte"],
        ["Félicité", "Sainte"],
        ["Jean de Dieu", "Saint"],
        ["Françoise", "Sainte"],
        ["Vivien", "Saint"],
        ["Rosine", "Sainte"],
        ["Justine", "Sainte"],
        ["Rodrigue", "Saint"],
        ["Mathilde", "Sainte"],
        ["Louise", "Sainte"],
        ["Bénédicte", "Sainte"],
        ["Patrice", "Saint"],
        ["Cyrille", "Saint"],
        ["Joseph", "Saint"],
        ["Herbert", "Saint"],
        ["Clémence", "Sainte"],
        ["Léa", "Sainte"],
        ["Victorien", "Saint"],
        ["Karine", "Sainte"],
        ["Anne", "Sainte"],
        ["Larissa", "Sainte"],
        ["Habib", "Saint"],
        ["Gontran", "Saint"],
        ["Gwladys", "Sainte"],
        ["Amédée", "Saint"],
        ["Benjamin", "Saint"]
    ],
    "Avril": [
        ["Hugues", "Saint"],
        ["Sandrine", "Sainte"],
        ["Richard", "Saint"],
        ["Isidore", "Saint"],
        ["Irène", "Sainte"],
        ["Marcellin", "Saint"],
        ["Jean-Baptiste de la Salle", "Saint"],
        ["Julie", "Sainte"],
        ["Gautier", "Saint"],
        ["Fulbert", "Saint"],
        ["Stanislas", "Saint"],
        ["Jules", "Saint"],
        ["Ida", "Sainte"],
        ["Maxime", "Saint"],
        ["Paterne", "Saint"],
        ["Benoît-Joseph", "Saint"],
        ["Anicet", "Saint"],
        ["Parfait", "Saint"],
        ["Emma", "Sainte"],
        ["Odette", "Sainte"],
        ["Anselme", "Saint"],
        ["Alexandre", "Saint"],
        ["Georges", "Saint"],
        ["Fidèle", "Saint"],
        ["Marc", "Saint"],
        ["Alida", "Sainte"],
        ["Zita", "Sainte"],
        ["Valérie", "Sainte"],
        ["Catherine de Sienne", "Sainte"],
        ["Robert", "Saint"]
    ],
    "Mai": [
        ["Fête du travail", ""],
        ["Boris", "Saint"],
        ["Philippe", "Saint"],
        ["Sylvain", "Saint"],
        ["Judith", "Saint"],
        ["Prudence", "Saint"],
        ["Gisèle", "Sainte"],
        ["Armistice de 1945", ""],
        ["Pacôme", "Saint"],
        ["Solange", "Sainte"],
        ["Estelle", "Sainte"],
        ["Achille", "Saint"],
        ["Rolande", "Sainte"],
        ["Matthias", "Saint"],
        ["Denise", "Sainte"],
        ["Honoré", "Saint"],
        ["Pascal", "Saint"],
        ["Eric", "Saint"],
        ["Yves", "Saint"],
        ["Bernardin", "Saint"],
        ["Constantin", "Saint"],
        ["Emile", "Saint"],
        ["Didier", "Saint"],
        ["Donatien", "Saint"],
        ["Sophie", "Sainte"],
        ["Bérenger", "Saint"],
        ["Augustin", "Saint"],
        ["Germain", "Saint"],
        ["Aymar", "Saint"],
        ["Ferdinand", "Saint"],
        ["Ferdinand", "Saint"]
    ],
    "Juin": [
        ["Justin", "Saint"],
        ["Blandine", "Sainte"],
        ["Kévin", "Saint"],
        ["Clotilde", "Sainte"],
        ["Igor", "Saint"],
        ["Norbert", "Saint"],
        ["Gilbert", "Saint"],
        ["Médard", "Saint"],
        ["Diane", "Sainte"],
        ["Landry", "Saint"],
        ["Barnabé", "Saint"],
        ["Guy", "Saint"],
        ["Antoine de Padoue", "Saint"],
        ["Elisée", "Sainte"],
        ["Germaine", "Sainte"],
        ["Jean-François Régis", "Saint"],
        ["Hervé", "Saint"],
        ["Léonce", "Saint"],
        ["Romuald", "Saint"],
        ["Silvère", "Saint"],
        ["Solstice d'été", ""],
        ["Alban", "Saint"],
        ["Audrey", "Sainte"],
        ["Jean-Baptiste", "Saint"],
        ["Prosper", "Saint"],
        ["Anthelme", "Saint"],
        ["Fernand", "Saint"],
        ["Irénée", "Saint"],
        ["Pierre", "Saint"],
        ["Martial", "Saint"]
    ],
    "Juillet": [
        ["Thierry", "Saint"],
        ["Martinien", "Saint"],
        ["Thomas", "Saint"],
        ["Florent", "Saint"],
        ["Antoine", "Saint"],
        ["Mariette", "Sainte"],
        ["Raoul", "Saint"],
        ["Thibault", "Saint"],
        ["Amandine", "Sainte"],
        ["Ulrich", "Saint"],
        ["Benoît", "Saint"],
        ["Olivier", "Saint"],
        ["Henri", "Saint"],
        ["Fête Nationale", ""],
        ["Donald", ""],
        ["Fête de Notre Dame du Mont Carmel", ""],
        ["Charlotte", "Sainte"],
        ["Frédéric", "Saint"],
        ["Arsène", "Saint"],
        ["Marina", "Sainte"],
        ["Victor", "Saint"],
        ["Marie-Madeleine", "Sainte"],
        ["Brigitte", "Sainte"],
        ["Christine", "Sainte"],
        ["Jacques", "Saint"],
        ["Anne", "Sainte"],
        ["Nathalie", "Sainte"],
        ["Samson", "Saint"],
        ["Marthe", "Sainte"],
        ["Juliette", "Sainte"],
        ["Ignace de Loyola", "Saint"]
    ],
    "Août": [
        ["Alphonse", "Saint"],
        ["Julien Eymard", "Saint"],
        ["Lydie", "Sainte"],
        ["Jean-Marie Vianney", "Saint"],
        ["Abel", "Saint"],
        ["Fête de la Transfiguration", ""],
        ["Gaétan", "Saint"],
        ["Dominique", "Saint"],
        ["Amour", "Saint"],
        ["Laurent", "Saint"],
        ["Claire", "Sainte"],
        ["Clarisse", "Sainte"],
        ["Hippolyte", "Saint"],
        ["Evrard", "Saint"],
        ["Fête de l'Assomption", ""],
        ["Armel", "Sainte"],
        ["Hyacinthe", "Saint"],
        ["Hélène", "Sainte"],
        ["Jean-Eudes", "Saint"],
        ["Bernard", "Saint"],
        ["Christophe", "Saint"],
        ["Fabrice", "Saint"],
        ["Rose de Lima", "Sainte"],
        ["Barthélémy", "Saint"],
        ["Louis", "Saint"],
        ["Natacha", "Sainte"],
        ["Monique", "Sainte"],
        ["Augustin", "Saint"],
        ["Sabine", "Sainte"],
        ["Fiacre", "Saint"],
        ["Aristide", "Saint"]
    ],
    "Septembre": [
        ["Gilles", "Saint"],
        ["Ingrid", "Sainte"],
        ["Grégoire", "Saint"],
        ["Rosalie", "Sainte"],
        ["Raïssa", "Sainte"],
        ["Bertrand", "Saint"],
        ["Reine", "Sao,te"],
        ["Fête de la Nativité", ""],
        ["Alain", "Saint"],
        ["Inès", "Sainte"],
        ["Adelphe", "Saint"],
        ["Apollinaire", "Saint"],
        ["Aimé", "Saint"],
        ["Fête de la Croix Glorieuse", ""],
        ["Roland", "Saint"],
        ["Edith", "Sainte"],
        ["Renaud", "Saint"],
        ["Nadège", "Sainte"],
        ["Emilie", "Sainte"],
        ["Davy", "Saint"],
        ["Matthieu", "Saint"],
        ["Maurice", "Saint"],
        ["Equinoxe d'Automne", ""],
        ["Thècle", "Sainte"],
        ["Hermann", "Saint"],
        ["Côme", "Saint"],
        ["Vincent de Paul", "Saint"],
        ["Venceslas", "Saint"],
        ["Michel", "Saint"],
        ["Jérôme", "Saint"]
    ],
    "Octobre": [
        ["Thérèse de l'Enfant Jésus", "Sainte"],
        ["Léger", "Saint"],
        ["Gérard", "Saint"],
        ["François d'Assise", "Saint"],
        ["Fleur", "Sainte"],
        ["Bruno", "Saint"],
        ["Serge", "Saint"],
        ["Pélagie", "Sainte"],
        ["Denis", "Saint"],
        ["Ghislain", "Saint"],
        ["Firmin", "Saint"],
        ["Wilfried", "Saint"],
        ["Géraud", "Saint"],
        ["Juste", "Saint"],
        ["Thérèse d'Avila", "Saint"],
        ["Edwige", "Sainte"],
        ["Baudoin", "Saint"],
        ["Luc", "Saint"],
        ["René", "Saint"],
        ["Adeline", "Sainte"],
        ["Céline", "Sainte"],
        ["Elodie", "Sainte"],
        ["Jean de Capistran", "Saint"],
        ["Florentin", "Saint"],
        ["Crépin", "Saint"],
        ["Dimitri", "Saint"],
        ["Emeline", "Sainte"],
        ["Jude", "Saint"],
        ["Narcisse", "Saint"],
        ["Bienvenue", "Sainte"],
        ["Quentin", "Saint"]
    ],
    "Novembre": [
        ["Toussaint", ""],
        ["Fête des défunts", ""],
        ["Hubert", "Saint"],
        ["Charles", "Saint"],
        ["Sylvie", "Sainte"],
        ["Bertille", "Sainte"],
        ["Carine", "Sainte"],
        ["Geoffroy", "Saint"],
        ["Théodore", "Saint"],
        ["Léon", "Saint"],
        ["Armistice de 1918", ""],
        ["Christian", "Saint"],
        ["Brice", "Saint"],
        ["Sidoine", "Saint"],
        ["Albert", "Saint"],
        ["Marguerite", "Sainte"],
        ["Elisabeth", "Sainte"],
        ["Aude", "Sainte"],
        ["Tanguy", "Saint"],
        ["Edmond", "Saint"],
        ["Présence de Marie", ""],
        ["Cécile", "Sainte"],
        ["Clément", "Saint"],
        ["Flora", "Sainte"],
        ["Catherine", "Sainte"],
        ["Delphine", "Sainte"],
        ["Sévrin", "Saint"],
        ["Jacques de la Marche", "Saint"],
        ["Saturnin", "Saint"],
        ["André", "Saint"]
    ],
    "Décembre": [
        ["Florence", "Sainte"],
        ["Viviane", "Sainte"],
        ["François-Xavier", "Saint"],
        ["Barbara", "Sainte"],
        ["Gérald", "Saint"],
        ["Nicolas", "Saint"],
        ["Ambroise", "Sainte"],
        ["Fête de l'Immaculée Conception", ""],
        ["Pierre Fourier", "Saint"],
        ["Romaric", "Saint"],
        ["Daniel", "Saint"],
        ["Jeanne-Françoise de Chantal", "Sainte"],
        ["Lucie", "Sainte"],
        ["Odile", "Sainte"],
        ["Ninon", "Sainte"],
        ["Alice", "Sainte"],
        ["Gaël", "Saint"],
        ["Gatien", "Saint"],
        ["Urbain", "Saint"],
        ["Théophile", "Saint"],
        ["Solstice d'Hiver", ""],
        ["Françoise-Xavière", "Sainte"],
        ["Armand", "Saint"],
        ["Adèle", "Sainte"],
        ["Noël", ""],
        ["Etienne", "Saint"],
        ["Jean", "Saint"],
        ["Innocents", "Saints"],
        ["David", "Saint"],
        ["Roger", "Saint"],
        ["Sylvestre", "Saint"]
    ]
}

let visibility_text = document.querySelector("#visibility_text");
let section1 = document.querySelector("#section1");
let section2 = document.querySelector("#section2");
let visibility_calendar = document.querySelector("#visibility_calendar");
let resultat_jours_feries = document.querySelector("#resultat_jours_feries");
let resultat_vacances = document.querySelector("#resultat_vacances");
let btn_text = document.querySelector("#btn_text");
let input_focus = document.querySelector("#annee");
let title_principal = document.querySelector("#title_principal");
let title_jours_feries = document.querySelector("#title_jours_feries");
let title_vacances = document.querySelector("#title_vacances");
let form = document.querySelector("#form");
let containerJoursFeries = document.createElement("div");
const aujourdhui = new Date();
let fetchData;




const options = {
    weekday: 'long',
    year: 'numeric',
    month: 'long',
    day: 'numeric'
};

function handleCalendrierClick(annee, ephemeride, data) {
    //console.log("btn_calendrier cliqué");
    visibility_text.classList.add("hidden");
    visibility_calendar.classList.remove("hidden");
    title_principal.classList.remove("hidden");
    section1.classList.add("hidden");
    section2.classList.add("hidden");
    // Effacer le contenu des sections jours fériés et vacances
    resultat_jours_feries.innerHTML = '';
    resultat_vacances.innerHTML = '';


    let str = "à l'île de la";
    title_principal.textContent = `${str[0].toUpperCase()}${str.slice(1)} ${data['vacances'][0].location} pour l'année scolaire ${data['vacances'][0].annee_scolaire}`;

    createCalendar(annee, ephemeride, data);

}

function handleTextClick(data) {
    //console.log("btn_text cliqué");
    visibility_calendar.classList.add("hidden");
    visibility_text.classList.remove("hidden");
    title_principal.classList.remove("hidden");
    section1.classList.remove("hidden");
    section2.classList.remove("hidden");

    //console.log("data", data);
    resultat_jours_feries.textContent = "";
    resultat_vacances.textContent = "";

    createText(data);
}

// Gestionnaire d'événements pour la soumission du formulaire
// Détermine le bouton cliqué et appelle la fonction correspondante
form.addEventListener('submit', async (e) => {
    e.preventDefault();

    let buttonClicked = document.activeElement.id;
    console.log("buttonClicked", typeof buttonClicked);
    const anneeSaisie = e.target[0].value;

    if (!estAnneeValide(anneeSaisie)) {
        alert("Merci d'entrer une année valide (un nombre à quatre chiffres)");
        title_principal.classList.add("hidden");
        return;
    }

    // Réinitialiser fetchData et récupérer les nouvelles données
    fetchData = await getData(parseInt(anneeSaisie));

    switch (buttonClicked) {
        case "btn_calendrier":

            handleCalendrierClick(e.target[0].value, ephemeride, fetchData);
            break;
        case "btn_text":

            handleTextClick(fetchData);
            break;

        default:
            break;
    }


});